#### 加密、公钥、私钥、签名和验签

##### 1.加密

###### 对称加密

![](https://gitee.com/enioy/img/raw/master/K8S/20201128141249.png) 



###### 非对称加密

![](https://gitee.com/enioy/img/raw/master/K8S/20201128141322.png) 

发送方给接收方发送消息，发送方用密钥A加密，接收方用密钥B解密

接收方给发送方发送消息，接收方用密钥C加密，发送方用密钥D解密

| **签名算法** | **标准签名算法** | **描述**                                        |
| ------------ | ---------------- | ----------------------------------------------- |
| RSA2         | SHA256WithRSA    | 强制要求 RSA 密钥的长度至少为 2048。            |
| RSA          | SHA1WithRSA      | 对 RSA 密钥的长度不限制，推荐使用 2048 位以上。 |



##### 2.公钥私钥

公钥和私钥是一个相对概念

它们的公私性是相对于生成者来说的

一对密钥生成后,保存在生成者手里的就是私钥

生成者发布出去大家用的就是公钥

密钥A是私钥，密钥B是公钥

密钥C是私钥，密钥D是公钥



##### 3.签名验签

- 签名：将传送的消息用私钥加密的过程。
- 验签：使用公钥对消息进行验证的过程。

签名和验签的过程

1. 生成签名方（通常为商户）首先将参数放入一个字符串数组 signFields，把参数和值放入一个对象或 map 中，使用 JSONObject 把这个对象转化成 json 对象。然后构建签名原文，在构建签名原文时，需要把参数按照字典（比如 a，b，c）顺序排序（具体排序方法直接调用 JAVA 的 Arrays.sort 方法），最后使用 RSA 的私钥对签名原文进行签名。
2. 验签方（通常为开放平台的服务端）：和生产签名方一样先生成签名原文，然后使用 RSA 的公钥生成签名方传入的签名并通过签名原文验证该签名，验证结果为 true 则验证成功，否则验证未通过。



![](https://gitee.com/enioy/img/raw/master/K8S/20201128153402.png)  



![](https://gitee.com/enioy/img/raw/master/K8S/20201128142833.png)

 

